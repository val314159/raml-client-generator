#!/usr/bin/python

import requests,json

{{#each allMethods}}
def rpc{{flatPath resource}}_{{method}}(self,
  {{#each resource.uriParameters}}{{displayName}}=None,{{/each}} #uri
  {{#each queryParameters}}{{@key}}=None,{{/each}} # query
  {{#each body}}{{#each formParameters}}{{@key}}=None,{{/each}}{{/each}} # form
):
   """
  {{{description}}}
  """
   path='{{fullPath resource}}'

   uri=path
{{#each resource.uriParameters}}
   uri=uri.replace('{'+'{{displayName}}'+'}',{{displayName}})
{{/each}}

   query={}
{{#each queryParameters}}
   query['{{@key}}']={{@key}}
{{/each}}

   qstr='&'.join([(str(k)+'='+str(v)) for k,v in query.iteritems()])
   if qstr: qstr='?'+qstr
   if '{{method}}' in ('post','put','patch'):
       form={}
{{#each body}}{{#each formParameters}}
       form['{{@key}}']={{@key}}
{{/each}}{{/each}}
       body = urllib.urlencode(form)
       #return requests.{{method}}(url+qstr,data=form)
   else:
       body = None
       pass#return requests.{{method}}(url+qstr)
   return requests.{{method}}(url+qstr,data=body)

{{/each}}

def main():
  print "main"
  pass

if __name__=='__main__': main()
